{"version":3,"sources":["../../src/lib/convert.js"],"names":["LOG","resize","file","files","delay","args","getConvertArgs","allArgs","join","stderr","promise","on","data","colors","optimize","push"],"mappings":";;;;;;;AAAA;;AACA;;;;AACA,MAAMA,MAAM,oBAAS,SAAT,CAAZ;;eAGe,OAAO;AACpBC,QADoB;AACZC,MADY;AACNC,OADM;AACCC;AADD,CAAP,KAET;AACJ,QAAMC,OAAOC,eAAe;AAC1BL,UAD0B;AAE1BG;AAF0B,GAAf,CAAb;AAIA,QAAMG,UAAU,CAAC,GAAGJ,KAAJ,EAAW,GAAGE,IAAd,EAAoBH,IAApB,CAAhB;AACAF,MAAI,OAAJ,EAAa,SAAb,EAAwBO,QAAQC,IAAR,CAAa,GAAb,CAAxB;AACA,QAAM;AAAEC,UAAF;AAAUC;AAAV,MAAsB,2BAAM,SAAN,EAAiBH,OAAjB,CAA5B;AACAE,SAAOE,EAAP,CAAU,MAAV,EAAmBC,IAAD,IAAU;AAC1BZ,QAAK,GAAEY,IAAK,EAAZ;AACD,GAFD;AAGA,QAAMF,OAAN;AACA,SAAOR,IAAP;AACD,C;;;;AAED,MAAMI,iBAAiB,CAAC;AACtBL,QADsB;AAEtBY,QAFsB;AAGtBC,aAAW,eAHW;AAItBV,OAJsB,CAKtB;;AALsB,IAMpB,EANmB,KAMZ;AACT,QAAMC,OAAO,EAAb;AACA,MAAIJ,MAAJ,EAAYI,KAAKU,IAAL,CAAU,SAAV,EAAqBd,MAArB;AACZ,MAAIY,MAAJ,EAAYR,KAAKU,IAAL,CAAU,SAAV,EAAqBF,MAArB;AACZ,MAAIC,QAAJ,EAAcT,KAAKU,IAAL,CAAU,SAAV,EAAqBD,QAArB;AACd,MAAIV,KAAJ,EAAWC,KAAKU,IAAL,CAAU,QAAV,EAAoBX,QAAQ,EAA5B;AACX,SAAOC,IAAP;AACD,CAbD","sourcesContent":["import spawn from 'spawncommand'\nimport { debuglog } from 'util'\nconst LOG = debuglog('appshot')\n\n\nexport default async ({\n  resize, file, files, delay,\n}) => {\n  const args = getConvertArgs({\n    resize,\n    delay,\n  })\n  const allArgs = [...files, ...args, file]\n  LOG('%s %s', 'convert', allArgs.join(' '))\n  const { stderr, promise } = spawn('convert', allArgs)\n  stderr.on('data', (data) => {\n    LOG(`${data}`)\n  })\n  await promise\n  return file\n}\n\nconst getConvertArgs = ({\n  resize,\n  colors,\n  optimize = 'OptimizeFrame',\n  delay,\n  // disposal,\n} = {}) => {\n  const args = []\n  if (resize) args.push('-resize', resize)\n  if (colors) args.push('-colors', colors)\n  if (optimize) args.push('-layers', optimize)\n  if (delay) args.push('-delay', delay / 10)\n  return args\n}\n"],"file":"convert.js"}